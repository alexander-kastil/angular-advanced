<app-markdown-renderer [md]="'sf-arrays'" />
<mat-card appearance="outlined">
  <mat-card-header>
    <mat-card-title>Signal Forms - Arrays (Simple Repeating Fields)</mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <form autocomplete="off" column>
      <mat-form-field>
        <mat-label>Pet Name
          @if (petForm.petName().required()) { <span class="text-danger">*</span> }
        </mat-label>
        <input matInput type="text" [formField]="petForm.petName" placeholder="Pet name" />
      </mat-form-field>
      @if (petForm.petName().invalid() && petForm.petName().touched()) {
        @for (err of petForm.petName().errors(); track err.kind) {
          <div class="error">{{ err.message }}</div>
        }
      }

      <div class="array-section">
        <strong>Nicknames</strong>
        <div class="array-items">
          @for (nick of petModel().nicknames; track $index) {
            <div class="array-row">
              <mat-form-field class="flex-grow">
                <mat-label>Nickname {{ $index + 1 }}</mat-label>
                <input matInput type="text"
                       [formField]="petForm.nicknames[$index]"
                       [id]="'nickname' + $index"
                       placeholder="Nickname" />
              </mat-form-field>
              <button mat-stroked-button color="warn" type="button" (click)="removeNickname($index)">âœ•</button>
            </div>
            @let nickField = petForm.nicknames[$index];
            @if (nickField().invalid() && nickField().touched()) {
              @for (err of nickField().errors(); track err.kind) {
                <div class="error">{{ err.message }}</div>
              }
            }
          } @empty {
            <div class="empty">No nicknames yet. Click "Add Nickname" to start.</div>
          }
        </div>
        <button mat-stroked-button type="button" (click)="addNickname()">+ Add Nickname</button>
      </div>

      <div class="form-actions">
        <button mat-raised-button color="primary" type="button"
                [disabled]="petForm().invalid()" (click)="onSubmit()">Save</button>
        <button mat-stroked-button type="button" (click)="onCancel()">Cancel</button>
      </div>
    </form>
  </mat-card-content>
</mat-card>

<mat-card appearance="outlined">
  <mat-card-header>
    <mat-card-title>State</mat-card-title>
  </mat-card-header>
  <mat-card-content>
    Form valid: {{ petForm().valid() }}<br />
    Model: <pre>{{ petModel() | json }}</pre>
  </mat-card-content>
</mat-card>
